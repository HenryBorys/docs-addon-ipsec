---
title: Renewing Expired IPsec Credentials
owner: Security Engineering
---

<strong><%= modified_date %></strong>

This topic describes the process Pivotal recommends to renew expired certificates used in the IPsec manifest.

To renew expired IPsec credentials, do the following:

1. Retrieve the latest runtime config by running the following command:
  <pre>
    bosh runtime-config > PATH-TO-RUNTIME-CONFIG
  </pre>

2. Generate a new set of certificates. 
   For development or test environments, you can use self-signed certificates. 
   For information about self-signed certificates, see [Generate a Self-Signed Certificate](./installing.html#self-signed).

3. In the runtime `config.yml` file saved from step 1, update the `optional` field to `true` and update the certificate fields with new certificates. 
   For more information about these fields,
   see the field descriptions under [Create the IPsec Manifest](./installing.html#create-mfest).
    <pre>
    properties:
        ipsec:
          <strong>optional</strong>: true
          <strong>instance\_certificate</strong>: |
            -----BEGIN CERTIFICATE-----
            EXAMPLEAhigAwIBAgIRAIvrBY2TttU/LeRhO+V1t0YwDQYJKoZIhvcNAQELBQAw
            ...
            -----END CERTIFICATE-----
          <strong>instance\_private\_key</strong>: |
            -----BEGIN RSA PRIVATE KEY-----
            EXAMPLExRSAxPRIVATExKEYxDATAxEXAMPLExRSAxPRIVATExKEYxDATA
            ...
            -----END RSA PRIVATE KEY-----
          <strong>ca\_certificates</strong>:
            \- |
              -----BEGIN CERTIFICATE-----
              ExampleAvGgAwIBAgIBATANBgkqhkiG9w0BAQsFADAUMRIwEAYDVQQDEwl0ZXN0
              ...
              -----END CERTIFICATE-----
            \- |
              -----BEGIN CERTIFICATE-----
              ExampleAvGgAwIBAgIBATAAYDVQQDEwl0ZXN0NBgkqhkiG9w0BAQsFADAUMRIwE
              ...
              -----END CERTIFICATE-----
    </pre>

4. Change the release version.
  <pre>
releases:
\- {name: ipsec, version: NEW\_VERSION}
  </pre>

5. Update the runtime config by running the following command:
  <pre>
    bosh update runtime-config PATH-TO-SAVE-THE-RUNTIME-CONFIG
  </pre>

6. Navigate to your **Installation Dashboard** in Ops Manager.
7. Click **Apply Changes**.
8. Remove the `optional: true` set in step 3.
9. Repeat steps 5 to 7.
