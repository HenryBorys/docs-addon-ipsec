---
title: Rotating IPsec Credentials
owner: Security Engineering
---

blocked, w8ing on secTeam review

#Rotating Credentials

Rotating IPsec Credentials
This topic describes the process Pivotal recommends to increase deployment security by rotating credentials in the IPsec manifest. Your organizational security policy may specify how often you should apply these changes. 

There are two different ways to perform credential rotation: 
The first procedure rotate the Instance Certificate and Instance Private Key specified in your IPsec manifest, and requires updating BOSH. 
The second procedure rotates your Instance Certificate, Instance Private Key and the CA Certificate. If you choose to rotate your CA Certificate, this procedure requires updating BOSH three times.

Note: The rolling deploys during these procedures result in minimal deployment downtime.

Rotate the Instance Certificate and Instance Private Key:
Generate a new certificate and use your existing IPsec CA to sign the new certificate.  [code for `openssl genrsa -des3 -out root-ca.key 1024` or similar? We need the code.]
Update the instance certificate and the private key fields in your ipsec-addon.yml file with new values from the previous step.
Run `$ bosh update runtime-config PATH/MYPRODUCT_ipsec-addon.yml`
Navigate to your Ops Manager interface in a browser, and click **Apply Changes**. 

Rotate the CA Certificate, the Instance Certificate, and Instance Private Key:
Generate a new CA. [code for `openssl genrsa -des3 -out root-ca.key 1024` or similar? We need the code.]
Append the newly generated CA certificate under the existing certificate in your ipsec-addon.yml.
Run `$ bosh update runtime-config PATH/MYPRODUCT_ipsec-addon.yml`
Navigate to your Ops Manager interface in a browser, and click **Apply Changes**
Generate a new certificate and use your new IPsec CA to sign the new certificate.  [code for `openssl genrsa -des3 -out root-ca.key 1024` or similar? We need the code.]
Update the instance certificate and the private key fields in the .yml file with new values from above.
Run `$ bosh update runtime-config PATH/MYPRODUCT_ipsec-addon.yml`
Navigate to your Ops Manager interface in a browser, and click **Apply Changes**. 
Delete the older ca_certificate in the `ipsec-addon.yml` file.
Run `$ bosh update runtime-config PATH/MYPRODUCT_ipsec-addon.yml`
Navigate to your Ops Manager interface in a browser, and click **Apply Changes**.
 


