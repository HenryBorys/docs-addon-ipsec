---
title: Rotating IPsec Credentials
owner: Security Engineering
---

<strong><%= modified_date %></strong>

This topic describes the process Pivotal recommends to increase deployment security by
rotating credentials in the IPsec manifest. Your organizational security policy may specify 
how often you should apply these changes. 

There are two different ways to perform credential rotation: 

* The first procedure rotate the Instance Certificate and Instance Private Key specified in 
  your IPsec manifest, and requires updating BOSH. 

* The second procedure rotates your Instance Certificate, Instance Private Key and the 
  CA Certificate. If you choose to rotate your CA Certificate, this procedure requires 
  updating BOSH three times.

<p class="note"><strong>Note</strong>: The rolling deploys during these procedures result in minimal deployment downtime.</p>

## <a id="rotate-cert"></a>Rotate the Instance Certificate and Instance Private Key

1. Generate a new certificate and use your existing IPsec CA to sign the new certificate. 

2. Update the instance certificate and the private key fields in your `ipsec-addon.yml` file 
 with new values from the previous step.

3. Run `$ bosh update runtime-config PATH/MYPRODUCT_ipsec-addon.yml`

4. Navigate to your Ops Manager interface in a browser, and click **Apply Changes**. 

## <a id="rotate-CA"></a>Rotate the CA Certificate, the Instance Certificate, and Instance Private Key

1. Generate a new CA.

2. Append the newly generated CA certificate under the existing certificate in your `ipsec-addon.yml`.

3. Run `$ bosh update runtime-config PATH/MYPRODUCT_ipsec-addon.yml`

4. Navigate to your Ops Manager interface in a browser, and click **Apply Changes**.

5. Generate a new certificate and use your new IPsec CA to sign the new certificate.

6. Update the instance certificate and the private key fields in the `.yml` file with new values from above.

7. Run `$ bosh update runtime-config PATH/MYPRODUCT_ipsec-addon.yml`

8. Navigate to your Ops Manager interface in a browser, and click **Apply Changes**.

9. Delete the older ca\_certificate in the `ipsec-addon.yml` file.

10. Run `$ bosh update runtime-config PATH/MYPRODUCT_ipsec-addon.yml`

11. Navigate to your Ops Manager interface in a browser, and click **Apply Changes**.

